webpackJsonp([3],{"+Ofk":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("Xxa5"),l=a.n(s),i=a("exGp"),r=a.n(i),o=a("woOf"),n=a.n(o),c={props:["vs","ea","editForm"],data:function(){return{dialogVisible:!1,pid:"",form:{title:"",type:"",level:"",creator:"",createTime:"",desc:""},defaultFrom:{title:"",type:"",level:"",creator:"",createTime:"",desc:""},level:[{value:"高",label:"高"},{value:"中",label:"中"},{value:"低",label:"低"}],type:[{value:"功能测试",label:"功能测试"},{value:"性能测试",label:"性能测试"},{value:"安全测试",label:"安全测试"},{value:"兼容性测试",label:"兼容性测试"},{value:"界面测试",label:"界面测试"},{value:"场景测试",label:"场景测试"}]}},watch:{vs:function(e){e&&(this.dialogVisible=e)},editForm:function(e){e!==[]&&(this.form=e[0])}},methods:{setVs:function(){this.$emit("getVs",!1)},resetFrom:function(){this.form=n()({},this.form,this.defaultFrom)},setPid:function(){var e=this;return r()(l.a.mark(function t(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",sessionStorage.getItem("pid"));case 1:case"end":return e.stop()}},t,e)}))()},createTestCase:function(){var e=this;return r()(l.a.mark(function t(){var a;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.setPid();case 2:a=t.sent,e.$axios.post("api/project/testcase/add/",{form:e.form,pid:a}).then(function(t){var a=t.data;"000000"===a.respCode?(e.$message.success("新增成功"),e.$emit("fresh",!0),e.resetFrom()):e.$message.error(a.respMsg)});case 4:case"end":return t.stop()}},t,e)}))()},editTestCase:function(e){var t=this;this.$axios.post("api/project/testcase/edit/",{form:this.form,rid:e}).then(function(e){var a=e.data;"000000"===a.respCode?(t.$message.success("修改成功"),t.$emit("fresh",!0),t.resetFrom()):t.$message.error(a.respMsg)})}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{visible:e.dialogVisible,width:"80%"},on:{close:function(t){e.dialogVisible=!1,e.setVs()}}},[a("div",{attrs:{slot:"title"},slot:"title"},["add"===e.ea?a("span",[e._v("创建用例")]):"edit"===e.ea?a("span",[e._v("修改用例")]):e._e(),e._v(" "),a("el-divider",{staticStyle:{margin:"24px 0 0 0"}})],1),e._v(" "),a("el-form",{model:{value:e.form,callback:function(t){e.form=t},expression:"form"}},[a("el-row",{attrs:{gutter:30}},[a("el-col",{attrs:{span:16}},[a("div",[a("div",[a("el-form-item",{staticStyle:{"margin-bottom":"0"}},[a("el-input",{staticClass:"title_input",attrs:{size:"small",placeholder:"请输入标题"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1)],1),e._v(" "),a("div",[a("el-divider",{staticClass:"title_divider"})],1),e._v(" "),a("div",[a("el-form-item",[a("el-input",{staticClass:"desc_input",attrs:{type:"textarea",rows:10,placeholder:"请输入复现步骤"},model:{value:e.form.desc,callback:function(t){e.$set(e.form,"desc",t)},expression:"form.desc"}})],1)],1)])]),e._v(" "),a("el-col",{attrs:{span:1}},[a("el-divider",{attrs:{direction:"vertical"}})],1),e._v(" "),a("el-col",{attrs:{span:7}},[a("div",[a("div",[a("el-form-item",{attrs:{label:"用例等级"}},[a("el-select",{staticClass:"right_input_width",attrs:{size:"small"},model:{value:e.form.level,callback:function(t){e.$set(e.form,"level",t)},expression:"form.level"}},e._l(e.level,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"用例类型"}},[a("el-select",{staticClass:"right_input_width",attrs:{size:"small"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},e._l(e.type,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"创建人"}},[a("el-input",{staticClass:"right_input_width",attrs:{size:"small"},model:{value:e.form.creator,callback:function(t){e.$set(e.form,"creator",t)},expression:"form.creator"}})],1)],1)])]),e._v(" "),a("el-col",{attrs:{span:24}},[a("el-divider")],1),e._v(" "),"管理员"===e.$cookies.get("user_type")?a("el-col",{attrs:{span:24}},["add"===this.ea?a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){e.dialogVisible=!1,e.createTestCase(),e.setVs()}}},[e._v("创建")]):"edit"===this.ea?a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){e.dialogVisible=!1,e.editTestCase(e.form.id),e.setVs()}}},[e._v("修改")]):e._e(),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1,e.setVs(),e.resetFrom()}}},[e._v("取消")])],1):e._e()],1)],1)],1)],1)},staticRenderFns:[]};var p=a("VU/8")(c,d,!1,function(e){a("s9cT")},"data-v-8d10ee1a",null).exports,u=a("ZOEH"),v={components:{ShowLinkData:a("lK0L").a,LinkDialog:u.a,TestCaseDialog:p},data:function(){return{tableData:[],selectionArr:[],dialogVisible:!1,linkDialogVisible:!1,showLinkVisible:!1,pid:"",searchId:"",editOrAdd:"",editForm:[],selectValue:"",type:"",option:[{value:"正常",label:"正常"},{value:"通过",label:"通过"},{value:"不通过",label:"不通过"},{value:"延期",label:"延期"}],typeOption:[{value:"功能测试",label:"功能测试"},{value:"性能测试",label:"性能测试"},{value:"安全测试",label:"安全测试"},{value:"兼容性测试",label:"兼容性测试"},{value:"界面测试",label:"界面测试"},{value:"场景测试",label:"场景测试"}]}},created:function(){this.pid=sessionStorage.getItem("pid"),this.getTestCaseInfo(this.pid)},methods:{getVs:function(e){this.dialogVisible=e},getLinkDialogVs:function(e){this.linkDialogVisible=e},getShowLinkVs:function(e){this.showLinkVisible=e},fresh:function(e){e&&this.getTestCaseInfo(this.pid)},getTestCaseInfo:function(e){var t=this;this.$axios.get("api/project/testcase/info/",{params:{pid:e}}).then(function(e){var a=e.data;"000000"===a.respCode?t.tableData=a.list:t.$message.error(a.respMsg)})},getEditTestCaseForm:function(e){var t=this;this.$axios.get("api/project/testcase/info/",{params:{rid:e}}).then(function(e){var a=e.data;"000000"===a.respCode?t.editForm=a.list:t.$message.error(a.respMsg)})},delTestCase:function(e){var t=this;this.$axios.get("api/project/testcase/del/",{params:{rid:e}}).then(function(e){var a=e.data;"000000"===a.respCode?(t.$message.success("删除成功"),t.getTestCaseInfo(t.pid)):t.$message.error(a.respMsg)})},stateChange:function(e,t){var a=this;this.$axios.post("api/project/testcase/updateState/",{rid:e,newState:t}).then(function(e){var t=e.data;"000000"===t.respCode?a.getTestCaseInfo(a.pid):a.$message.error(t.respMsg)})},searchTestCaseType:function(e){var t=this;this.$axios.get("api/project/testcase/info/",{params:{pid:e,type:this.type}}).then(function(e){var a=e.data;"000000"===a.respCode?t.tableData=a.list:console.log(a.respMsg)})},clearTypeSelect:function(){this.getTestCaseInfo(this.pid)},dropdownCommand:function(e){"link"===e&&(this.selectionArr[0]?this.linkDialogVisible=!0:this.$message.info("请勾选需要进行绑定操作的用例"))},selectionChange:function(e){this.selectionArr=e},setTestCaseId:function(e){this.searchId=e}}},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticStyle:{"margin-bottom":"10px"}},[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-circle-plus-outline"},on:{click:function(t){e.dialogVisible=!0,e.editOrAdd="add"}}},[e._v("\n      创建用例\n    ")]),e._v(" "),a("el-dropdown",{on:{command:e.dropdownCommand}},[a("el-button",{attrs:{type:"primary",plain:"",size:"small"}},[e._v("更多操作"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{icon:"el-icon-upload2"}},[e._v("导入用例")]),e._v(" "),a("el-dropdown-item",{attrs:{icon:"el-icon-download"}},[e._v("导出用例")]),e._v(" "),a("el-dropdown-item",{attrs:{icon:"el-icon-link",command:"link"}},[e._v("关联需求")])],1)],1),e._v(" "),a("div",{staticClass:"search_input"},[a("el-select",{attrs:{clearable:"",size:"small",placeholder:"选择用例类型进行搜索"},on:{change:function(t){return e.searchTestCaseType(e.pid)},clear:e.clearTypeSelect},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},e._l(e.typeOption,function(e){return a("el-option",{key:e.value,attrs:{value:e.value,label:e.label}})}),1)],1)],1),e._v(" "),a("div",[a("el-card",[a("el-table",{staticStyle:{width:"100%","min-height":"65vh"},attrs:{data:e.tableData,"max-height":"70vh"},on:{"selection-change":e.selectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{label:"#",type:"index",width:"50",align:"align"}}),e._v(" "),a("el-table-column",{attrs:{label:"标题",prop:"title",width:"300"}}),e._v(" "),a("el-table-column",{attrs:{label:"用例类型",prop:"type"}}),e._v(" "),a("el-table-column",{attrs:{label:"用例等级",prop:"level"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{},["高"===t.row.level?a("el-tag",{attrs:{effect:"dark",type:"danger",size:"small"}},[e._v(e._s(t.row.level))]):"中"===t.row.level?a("el-tag",{attrs:{effect:"dark",type:"success",size:"small"}},[e._v(e._s(t.row.level))]):a("el-tag",{attrs:{effect:"dark",type:"info",size:"small"}},[e._v(e._s(t.row.level))])],1)}}])}),e._v(" "),a("el-table-column",{attrs:{label:"用例状态",prop:"state"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{attrs:{size:"small"},on:{change:function(a){return e.stateChange(t.row.id,t.row.state)}},model:{value:t.row.state,callback:function(a){e.$set(t.row,"state",a)},expression:"scope.row.state"}},e._l(e.option,function(e){return a("el-option",{key:e.value,attrs:{value:e.value,label:e.label}})}),1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"创建人",prop:"creator"}}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间",prop:"createTime"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{},[a("el-button",{attrs:{size:"small",type:"warning"},on:{click:function(a){e.dialogVisible=!0,e.editOrAdd="edit",e.getEditTestCaseForm(t.row.id)}}},[e._v("详情")]),e._v(" "),"管理员"===e.$cookies.get("user_type")?a("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(a){return e.delTestCase(t.row.id)}}},[e._v("删除")]):e._e(),e._v(" "),"管理员"===e.$cookies.get("user_type")?a("el-button",{staticStyle:{"margin-top":"5px"},attrs:{size:"small",type:"primary"},on:{click:function(a){e.showLinkVisible=!0,e.setTestCaseId(t.row.id)}}},[e._v("查看绑定的缺陷")]):e._e()],1)}}])})],1)],1)],1),e._v(" "),a("LinkDialog",{attrs:{vs:e.linkDialogVisible,type:"requirement",selectionArr:this.selectionArr},on:{getLinkDialogVs:e.getLinkDialogVs}}),e._v(" "),a("TestCaseDialog",{attrs:{vs:e.dialogVisible,ea:e.editOrAdd,editForm:e.editForm},on:{getVs:e.getVs,fresh:e.fresh}}),e._v(" "),a("ShowLinkData",{attrs:{vs:e.showLinkVisible,type:"testCase",searchId:e.searchId},on:{getShowLinkVs:e.getShowLinkVs}})],1)},staticRenderFns:[]};var m=a("VU/8")(v,f,!1,function(e){a("BVrc")},"data-v-e7ae45a4",null);t.default=m.exports},BVrc:function(e,t){},LMOa:function(e,t){},NHZl:function(e,t){},ZOEH:function(e,t,a){"use strict";var s=a("Xxa5"),l=a.n(s),i=a("exGp"),r=a.n(i),o={props:["vs","type","selectionArr"],data:function(){return{tableData:[],selection:[],pid:"",dialogVisible:!1}},mounted:function(){this.getTableData()},watch:{vs:function(e){!0===e&&(this.dialogVisible=!0)},selectionArr:function(e){if(e){var t=[];for(var a in e)t.push(e[a].id);this.selection=t}}},methods:{setVs:function(){this.$emit("getLinkDialogVs",!1)},getPid:function(){var e=this;return r()(l.a.mark(function t(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",sessionStorage.getItem("pid"));case 1:case"end":return e.stop()}},t,e)}))()},getTableData:function(){var e=this;return r()(l.a.mark(function t(){var a,s;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("requirement"!==e.type){t.next=7;break}return t.next=3,e.getPid();case 3:a=t.sent,e.$axios.get("api/project/requirement/info/",{params:{pid:a}}).then(function(t){var a=t.data;"000000"===a.respCode?e.tableData=a.list:e.$message.error(a.respMsg)}),t.next=11;break;case 7:return t.next=9,e.getPid();case 9:s=t.sent,e.$axios.get("api/project/testcase/info/",{params:{pid:s}}).then(function(t){var a=t.data;"000000"===a.respCode?e.tableData=a.list:e.$message.error(a.respMsg)});case 11:case"end":return t.stop()}},t,e)}))()},link:function(e){var t=this;"requirement"===this.type?this.$axios.post("api/project/testcase/link/",{selection:this.selection,rid:e}).then(function(e){var a=e.data;"000000"===a.respCode?t.$message.success("绑定成功"):t.$message.error(a.respMsg)}):this.$axios.post("api/project/defect/link/",{selection:this.selection,rid:e}).then(function(e){var a=e.data;"000000"===a.respCode?t.$message.success("绑定成功"):t.$message.error(a.respMsg)})}}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{width:"50%",visible:e.dialogVisible},on:{close:function(t){e.dialogVisible=!1,e.setVs()}}},[a("div",{attrs:{slot:"title"},slot:"title"},["requirement"===e.type?a("span",[e._v("绑定需求")]):a("span",[e._v("绑定用例")])]),e._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1,e.setVs()}}},[e._v("退出")])],1),e._v(" "),a("el-table",{attrs:{"max-height":"40vh",data:e.tableData}},[a("el-table-column",{attrs:{label:"ID",prop:"id"}}),e._v(" "),a("el-table-column",{attrs:{label:"标题",prop:"title"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{},[a("el-button",{attrs:{size:"small",type:"success"},on:{click:function(a){e.dialogVisible=!1,e.setVs(),e.link(t.row.id)}}},[e._v("绑定")])],1)}}])})],1)],1)],1)},staticRenderFns:[]};var c=a("VU/8")(o,n,!1,function(e){a("NHZl")},"data-v-0acfa7be",null);t.a=c.exports},lK0L:function(e,t,a){"use strict";var s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{visible:e.dialogVisible,width:"100%"},on:{close:function(t){e.dialogVisible=!1,e.setShowLinkVs()}}},[a("div",{attrs:{slot:"title"},slot:"title"},[a("span",[e._v("查看绑定数据")])]),e._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){e.dialogVisible=!1,e.setShowLinkVs()}}},[e._v("返回")])],1),e._v(" "),"requirement"===e.type?a("div",[a("el-table",{attrs:{data:e.tableData}},[a("el-table-column",{attrs:{label:"#",type:"index",width:"50",align:"align"}}),e._v(" "),a("el-table-column",{attrs:{label:"标题",prop:"title",width:"300"}}),e._v(" "),a("el-table-column",{attrs:{label:"用例类型",prop:"type"}}),e._v(" "),a("el-table-column",{attrs:{label:"用例等级",prop:"level"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{},["高"===t.row.level?a("el-tag",{attrs:{effect:"dark",type:"danger",size:"small"}},[e._v(e._s(t.row.level))]):"中"===t.row.level?a("el-tag",{attrs:{effect:"dark",type:"success",size:"small"}},[e._v(e._s(t.row.level))]):a("el-tag",{attrs:{effect:"dark",type:"info",size:"small"}},[e._v(e._s(t.row.level))])],1)}}],null,!1,1663379825)}),e._v(" "),a("el-table-column",{attrs:{label:"用例状态",prop:"state"}}),e._v(" "),a("el-table-column",{attrs:{label:"创建人",prop:"creator"}}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间",prop:"createTime"}})],1)],1):e._e(),e._v(" "),"testCase"===e.type?a("div",[a("el-table",{attrs:{data:e.tableData}},[a("el-table-column",{attrs:{label:"#",type:"index",width:"50",align:"align"}}),e._v(" "),a("el-table-column",{attrs:{label:"标题",prop:"title",width:"300"}}),e._v(" "),a("el-table-column",{attrs:{label:"优先级",prop:"priority"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{},["紧急"===t.row.priority?a("el-tag",{attrs:{effect:"dark",type:"danger",size:"small"}},[e._v(e._s(t.row.priority))]):"高"===t.row.priority?a("el-tag",{attrs:{effect:"dark",type:"warning",size:"small"}},[e._v(e._s(t.row.priority))]):"中"===t.row.priority?a("el-tag",{attrs:{effect:"dark",type:"success",size:"small"}},[e._v(e._s(t.row.priority))]):a("el-tag",{attrs:{effect:"dark",type:"info",size:"small"}},[e._v(e._s(t.row.priority))])],1)}}],null,!1,1461215397)}),e._v(" "),a("el-table-column",{attrs:{label:"严重程度",prop:"importance"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{},["致命"===t.row.importance?a("el-tag",{attrs:{effect:"dark",type:"danger",size:"small"}},[e._v(e._s(t.row.importance))]):"严重"===t.row.importance?a("el-tag",{attrs:{effect:"dark",type:"warning",size:"small"}},[e._v(e._s(t.row.importance))]):"一般"===t.row.importance?a("el-tag",{attrs:{effect:"dark",type:"success",size:"small"}},[e._v(e._s(t.row.importance))]):a("el-tag",{attrs:{effect:"dark",type:"info",size:"small"}},[e._v(e._s(t.row.importance))])],1)}}],null,!1,934285753)}),e._v(" "),a("el-table-column",{attrs:{label:"迭代",prop:"iteration"}}),e._v(" "),a("el-table-column",{attrs:{label:"状态",prop:"state"}}),e._v(" "),a("el-table-column",{attrs:{label:"处理人",prop:"handler"}}),e._v(" "),a("el-table-column",{attrs:{label:"创建人",prop:"creator"}}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间",prop:"createTime"}})],1)],1):e._e()])],1)},staticRenderFns:[]};var l=a("VU/8")({props:["vs","type","searchId"],data:function(){return{dialogVisible:!1,tableData:[]}},watch:{vs:function(e){e&&(this.dialogVisible=e)},searchId:function(e){e&&this.setTableData(e)}},methods:{setTableData:function(e){var t=this;"requirement"===this.type?this.$axios.get("api/project/testcase/info/",{params:{linkId:e}}).then(function(e){var a=e.data;"000000"===a.respCode?t.tableData=a.list:t.$message.error(a.respMsg)}):this.$axios.get("api/project/defect/info/",{params:{linkId:e}}).then(function(e){var a=e.data;"000000"===a.respCode?t.tableData=a.list:t.$message.error(a.respMsg)})},setShowLinkVs:function(){this.$emit("getShowLinkVs",!1)}}},s,!1,function(e){a("LMOa")},"data-v-158d3188",null);t.a=l.exports},s9cT:function(e,t){}});