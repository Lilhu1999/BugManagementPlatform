webpackJsonp([5],{"+dG1":function(t,e){},NHZl:function(t,e){},ZOEH:function(t,e,i){"use strict";var a=i("Xxa5"),r=i.n(a),s=i("exGp"),n=i.n(s),o={props:["vs","type","selectionArr"],data:function(){return{tableData:[],selection:[],pid:"",dialogVisible:!1}},mounted:function(){this.getTableData()},watch:{vs:function(t){!0===t&&(this.dialogVisible=!0)},selectionArr:function(t){if(t){var e=[];for(var i in t)e.push(t[i].id);this.selection=e}}},methods:{setVs:function(){this.$emit("getLinkDialogVs",!1)},getPid:function(){var t=this;return n()(r.a.mark(function e(){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",sessionStorage.getItem("pid"));case 1:case"end":return t.stop()}},e,t)}))()},getTableData:function(){var t=this;return n()(r.a.mark(function e(){var i,a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("requirement"!==t.type){e.next=7;break}return e.next=3,t.getPid();case 3:i=e.sent,t.$axios.get("api/project/requirement/info/",{params:{pid:i}}).then(function(e){var i=e.data;"000000"===i.respCode?t.tableData=i.list:t.$message.error(i.respMsg)}),e.next=11;break;case 7:return e.next=9,t.getPid();case 9:a=e.sent,t.$axios.get("api/project/testcase/info/",{params:{pid:a}}).then(function(e){var i=e.data;"000000"===i.respCode?t.tableData=i.list:t.$message.error(i.respMsg)});case 11:case"end":return e.stop()}},e,t)}))()},link:function(t){var e=this;"requirement"===this.type?this.$axios.post("api/project/testcase/link/",{selection:this.selection,rid:t}).then(function(t){var i=t.data;"000000"===i.respCode?e.$message.success("绑定成功"):e.$message.error(i.respMsg)}):this.$axios.post("api/project/defect/link/",{selection:this.selection,rid:t}).then(function(t){var i=t.data;"000000"===i.respCode?e.$message.success("绑定成功"):e.$message.error(i.respMsg)})}}},l={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-dialog",{attrs:{width:"50%",visible:t.dialogVisible},on:{close:function(e){t.dialogVisible=!1,t.setVs()}}},[i("div",{attrs:{slot:"title"},slot:"title"},["requirement"===t.type?i("span",[t._v("绑定需求")]):i("span",[t._v("绑定用例")])]),t._v(" "),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogVisible=!1,t.setVs()}}},[t._v("退出")])],1),t._v(" "),i("el-table",{attrs:{"max-height":"40vh",data:t.tableData}},[i("el-table-column",{attrs:{label:"ID",prop:"id"}}),t._v(" "),i("el-table-column",{attrs:{label:"标题",prop:"title"}}),t._v(" "),i("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return i("div",{},[i("el-button",{attrs:{size:"small",type:"success"},on:{click:function(i){t.dialogVisible=!1,t.setVs(),t.link(e.row.id)}}},[t._v("绑定")])],1)}}])})],1)],1)],1)},staticRenderFns:[]};var c=i("VU/8")(o,l,!1,function(t){i("NHZl")},"data-v-0acfa7be",null);e.a=c.exports},li33:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("Xxa5"),r=i.n(a),s=i("exGp"),n=i.n(s),o=i("woOf"),l=i.n(o),c={props:["vs","ea","editForm"],data:function(){return{dialogVisible:!1,pid:"",form:{title:"",priority:"",iteration:"",state:"",handler:"",creator:"",importance:"",createTime:"",desc:""},defaultFrom:{title:"",priority:"",iteration:"",state:"",handler:"",creator:"",importance:"",createTime:"",desc:""},iterationOption:[],priorityOption:[{value:"紧急",label:"紧急"},{value:"高",label:"高"},{value:"中",label:"中"},{value:"低",label:"低"}],importanceOption:[{value:"致命",label:"致命"},{value:"严重",label:"严重"},{value:"一般",label:"一般"},{value:"建议",label:"建议"}]}},watch:{vs:function(t){t&&(this.dialogVisible=t)},editForm:function(t){t!==[]&&(this.form=t[0])}},mounted:function(){this.getIterationData()},methods:{setVs:function(){this.$emit("getVs",!1)},resetFrom:function(){this.form=l()({},this.form,this.defaultFrom)},getIterationData:function(){var t=this;return n()(r.a.mark(function e(){var i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.setPid();case 2:i=e.sent,t.$axios.get("api/project/iteration/info/",{params:{pid:i}}).then(function(e){var i=e.data;"000000"===i.respCode?t.iterationOption=i.list:t.$message.error(i.respMsg)});case 4:case"end":return e.stop()}},e,t)}))()},setPid:function(){var t=this;return n()(r.a.mark(function e(){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",sessionStorage.getItem("pid"));case 1:case"end":return t.stop()}},e,t)}))()},createDefect:function(){var t=this;return n()(r.a.mark(function e(){var i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.setPid();case 2:i=e.sent,t.$axios.post("api/project/defect/add/",{form:t.form,pid:i}).then(function(e){var i=e.data;"000000"===i.respCode?(t.$message.success("新增成功"),t.$emit("fresh",!0),t.resetFrom()):t.$message.error(i.respMsg)});case 4:case"end":return e.stop()}},e,t)}))()},editDefect:function(t){var e=this;this.$axios.post("api/project/defect/edit/",{form:this.form,rid:t}).then(function(t){var i=t.data;"000000"===i.respCode?(e.$message.success("修改成功"),e.$emit("fresh",!0),e.resetFrom()):e.$message.error(i.respMsg)})}}},p={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-dialog",{attrs:{visible:t.dialogVisible,width:"80%"},on:{close:function(e){t.dialogVisible=!1,t.setVs()}}},[i("div",{attrs:{slot:"title"},slot:"title"},["add"===t.ea?i("span",[t._v("创建缺陷")]):"edit"===t.ea?i("span",[t._v("修改缺陷")]):t._e(),t._v(" "),i("el-divider",{staticStyle:{margin:"24px 0 0 0"}})],1),t._v(" "),i("el-form",{model:{value:t.form,callback:function(e){t.form=e},expression:"form"}},[i("el-row",{attrs:{gutter:30}},[i("el-col",{attrs:{span:16}},[i("div",[i("div",[i("el-form-item",{staticStyle:{"margin-bottom":"0"}},[i("el-input",{staticClass:"title_input",attrs:{size:"small",placeholder:"请输入标题"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1)],1),t._v(" "),i("div",[i("el-divider",{staticClass:"title_divider"})],1),t._v(" "),i("div",[i("el-form-item",[i("el-input",{staticClass:"desc_input",attrs:{type:"textarea",rows:10,placeholder:"请输入复现步骤"},model:{value:t.form.desc,callback:function(e){t.$set(t.form,"desc",e)},expression:"form.desc"}})],1)],1)])]),t._v(" "),i("el-col",{attrs:{span:1}},[i("el-divider",{attrs:{direction:"vertical"}})],1),t._v(" "),i("el-col",{attrs:{span:7}},[i("div",[i("div",[i("el-form-item",{attrs:{label:"迭代"}},[i("el-select",{staticClass:"right_input_width",attrs:{size:"small"},model:{value:t.form.iteration,callback:function(e){t.$set(t.form,"iteration",e)},expression:"form.iteration"}},t._l(t.iterationOption,function(t){return i("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})}),1)],1),t._v(" "),i("el-form-item",{attrs:{label:"严重程度"}},[i("el-select",{staticClass:"right_input_width",attrs:{size:"small"},model:{value:t.form.importance,callback:function(e){t.$set(t.form,"importance",e)},expression:"form.importance"}},t._l(t.importanceOption,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),i("el-form-item",{attrs:{label:"优先级"}},[i("el-select",{staticClass:"right_input_width",attrs:{size:"small"},model:{value:t.form.priority,callback:function(e){t.$set(t.form,"priority",e)},expression:"form.priority"}},t._l(t.priorityOption,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),i("el-form-item",{attrs:{label:"处理人"}},[i("el-input",{staticClass:"right_input_width",attrs:{size:"small"},model:{value:t.form.handler,callback:function(e){t.$set(t.form,"handler",e)},expression:"form.handler"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"创建人"}},[i("el-input",{staticClass:"right_input_width",attrs:{size:"small"},model:{value:t.form.creator,callback:function(e){t.$set(t.form,"creator",e)},expression:"form.creator"}})],1)],1)])]),t._v(" "),i("el-col",{attrs:{span:24}},[i("el-divider")],1),t._v(" "),"管理员"===t.$cookies.get("user_type")?i("el-col",{attrs:{span:24}},["add"===this.ea?i("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){t.dialogVisible=!1,t.createDefect(),t.setVs()}}},[t._v("创建")]):"edit"===this.ea?i("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){t.dialogVisible=!1,t.editDefect(t.form.id),t.setVs()}}},[t._v("修改")]):t._e(),t._v(" "),i("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogVisible=!1,t.setVs(),t.resetFrom()}}},[t._v("取消")])],1):t._e()],1)],1)],1)],1)},staticRenderFns:[]};var u=i("VU/8")(c,p,!1,function(t){i("+dG1")},"data-v-ebfefad4",null).exports,d=i("ZOEH"),f={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-popover",{attrs:{trigger:"hover"}},[i("div",[i("div",[i("div",{staticClass:"title_bottom"},[i("span",[t._v("优先级")])]),t._v(" "),i("el-button-group",[i("el-button",{attrs:{type:"全部"===t.options.priority?"primary":"",size:"small"},nativeOn:{click:function(e){return t.setOptions("priority","全部")}}},[t._v("全部")]),t._v(" "),i("el-button",{attrs:{type:"紧急"===t.options.priority?"primary":"",size:"small"},nativeOn:{click:function(e){return t.setOptions("priority","紧急")}}},[t._v("紧急")]),t._v(" "),i("el-button",{attrs:{type:"高"===t.options.priority?"primary":"",size:"small"},nativeOn:{click:function(e){return t.setOptions("priority","高")}}},[t._v("高")]),t._v(" "),i("el-button",{attrs:{type:"中"===t.options.priority?"primary":"",size:"small"},nativeOn:{click:function(e){return t.setOptions("priority","中")}}},[t._v("中")]),t._v(" "),i("el-button",{attrs:{type:"低"===t.options.priority?"primary":"",size:"small"},nativeOn:{click:function(e){return t.setOptions("priority","低")}}},[t._v("低")])],1)],1),t._v(" "),i("el-divider"),t._v(" "),i("div",[i("div",{staticClass:"title_bottom"},[i("span",[t._v("严重程度")])]),t._v(" "),i("el-button-group",[i("el-button",{attrs:{type:"全部"===t.options.importance?"primary":"",size:"small"},nativeOn:{click:function(e){return t.setOptions("importance","全部")}}},[t._v("全部")]),t._v(" "),i("el-button",{attrs:{type:"致命"===t.options.importance?"primary":"",size:"small"},nativeOn:{click:function(e){return t.setOptions("importance","致命")}}},[t._v("致命")]),t._v(" "),i("el-button",{attrs:{type:"严重"===t.options.importance?"primary":"",size:"small"},nativeOn:{click:function(e){return t.setOptions("importance","严重")}}},[t._v("严重")]),t._v(" "),i("el-button",{attrs:{type:"一般"===t.options.importance?"primary":"",size:"small"},nativeOn:{click:function(e){return t.setOptions("importance","一般")}}},[t._v("一般")]),t._v(" "),i("el-button",{attrs:{type:"建议"===t.options.importance?"primary":"",size:"small"},nativeOn:{click:function(e){return t.setOptions("importance","建议")}}},[t._v("建议")])],1)],1),t._v(" "),i("el-divider"),t._v(" "),i("div",[i("div",{staticClass:"title_bottom"},[i("span",[t._v("状态")])]),t._v(" "),i("el-button-group",[i("el-button",{attrs:{type:"全部"===t.options.state?"primary":"",size:"small"},nativeOn:{click:function(e){return t.setOptions("state","全部")}}},[t._v("全部")]),t._v(" "),i("el-button",{attrs:{type:"待修复"===t.options.state?"primary":"",size:"small"},nativeOn:{click:function(e){return t.setOptions("state","待解决")}}},[t._v("待解决")]),t._v(" "),i("el-button",{attrs:{type:"已修复"===t.options.state?"primary":"",size:"small"},nativeOn:{click:function(e){return t.setOptions("state","已解决")}}},[t._v("已解决")]),t._v(" "),i("el-button",{attrs:{type:"重新打开"===t.options.state?"primary":"",size:"small"},nativeOn:{click:function(e){return t.setOptions("state","重新打开")}}},[t._v("重新打开")]),t._v(" "),i("el-button",{attrs:{type:"关闭"===t.options.state?"primary":"",size:"small"},nativeOn:{click:function(e){return t.setOptions("state","已关闭")}}},[t._v("已关闭")])],1)],1)],1),t._v(" "),i("el-icon",{staticClass:"el-icon-setting",attrs:{slot:"reference"},slot:"reference"})],1)],1)},staticRenderFns:[]};var m=i("VU/8")({data:function(){return{options:{priority:"全部",importance:"全部",state:"全部"}}},mounted:function(){},watch:{options:{handler:function(t){t&&this.sendData()},deep:!0,immediate:!0}},methods:{sendData:function(){this.$emit("getSelectedData",this.options)},setOptions:function(t,e){this.$set(this.options,t,e)}}},f,!1,function(t){i("tpac")},"data-v-7bd31d06",null).exports,v={components:{LinkDialog:d.a,DefectDialog:u,ShaiXuan:m},data:function(){return{allData:[],tableData:[],selectionArr:[],dialogVisible:!1,linkDialogVisible:!1,pid:"",editOrAdd:"",editForm:[],selectValue:"",option:[{value:"待解决",label:"待解决"},{value:"已解决",label:"已解决"},{value:"重新打开",label:"重新打开"},{value:"已关闭",label:"已关闭"}]}},created:function(){this.pid=sessionStorage.getItem("pid"),this.getDefectInfo(this.pid)},methods:{getVs:function(t){this.dialogVisible=t},getLinkDialogVs:function(t){this.linkDialogVisible=t},getSelectedData:function(t){var e=this.allData,i=[],a=[];for(var r in t)if("全部"!==t[r]){for(var s in e)if(e[s][r]===t[r]){if(a.includes(e[s].id))continue;a.push(e[s].id),i.push(e[s])}e=i}this.tableData=e},fresh:function(t){t&&this.getDefectInfo(this.pid)},getDefectInfo:function(t){var e=this;this.$axios.get("api/project/defect/info/",{params:{pid:t}}).then(function(t){var i=t.data;"000000"===i.respCode?(e.allData=i.list,e.tableData=i.list):e.$message.error(i.respMsg)})},getEditDefectForm:function(t){var e=this;this.$axios.get("api/project/defect/info/",{params:{rid:t}}).then(function(t){var i=t.data;"000000"===i.respCode?e.editForm=i.list:e.$message.error(i.respMsg)})},delDefect:function(t){var e=this;this.$axios.get("api/project/defect/del/",{params:{rid:t}}).then(function(t){var i=t.data;"000000"===i.respCode?(e.$message.success("删除成功"),e.getDefectInfo(e.pid)):e.$message.error(i.respMsg)})},stateChange:function(t,e){var i=this;this.$axios.post("api/project/defect/updateState/",{rid:t,newState:e}).then(function(t){var e=t.data;"000000"===e.respCode?i.getDefectInfo(i.pid):i.$message.error(e.respMsg)})},dropdownCommand:function(t){"link"===t&&(this.selectionArr[0]?this.linkDialogVisible=!0:this.$message.info("请勾选需要进行绑定操作的缺陷"))},selectionChange:function(t){this.selectionArr=t},tableRowClassName:function(t){var e=t.row;t.rowIndex;return"已解决"===e.state?"success-row":"待解决"===e.state?"error-row":"重新打开"===e.state?"warning-row":""}}},_={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticStyle:{"margin-bottom":"10px"}},[i("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-circle-plus-outline"},on:{click:function(e){t.dialogVisible=!0,t.editOrAdd="add"}}},[t._v("\n      创建缺陷\n    ")]),t._v(" "),i("el-dropdown",{on:{command:t.dropdownCommand}},[i("el-button",{attrs:{type:"primary",plain:"",size:"small"}},[t._v("更多操作"),i("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{attrs:{icon:"el-icon-upload2"}},[t._v("导入缺陷")]),t._v(" "),i("el-dropdown-item",{attrs:{icon:"el-icon-download"}},[t._v("导出缺陷")]),t._v(" "),i("el-dropdown-item",{attrs:{icon:"el-icon-link",command:"link"}},[t._v("关联用例")])],1)],1),t._v(" "),i("ShaiXuan",{staticStyle:{float:"right"},on:{getSelectedData:t.getSelectedData}})],1),t._v(" "),i("div",[i("el-card",[i("el-table",{staticStyle:{width:"100%","min-height":"65vh"},attrs:{"row-class-name":t.tableRowClassName,data:t.tableData,"max-height":"70vh"},on:{"selection-change":t.selectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"50"}}),t._v(" "),i("el-table-column",{attrs:{label:"#",type:"index",width:"50",align:"align"}}),t._v(" "),i("el-table-column",{attrs:{label:"标题",prop:"title",width:"300"}}),t._v(" "),i("el-table-column",{attrs:{label:"优先级",prop:"priority"},scopedSlots:t._u([{key:"default",fn:function(e){return i("div",{},["紧急"===e.row.priority?i("el-tag",{attrs:{effect:"dark",type:"danger",size:"small"}},[t._v(t._s(e.row.priority))]):"高"===e.row.priority?i("el-tag",{attrs:{effect:"dark",type:"warning",size:"small"}},[t._v(t._s(e.row.priority))]):"中"===e.row.priority?i("el-tag",{attrs:{effect:"dark",type:"success",size:"small"}},[t._v(t._s(e.row.priority))]):i("el-tag",{attrs:{effect:"dark",type:"info",size:"small"}},[t._v(t._s(e.row.priority))])],1)}}])}),t._v(" "),i("el-table-column",{attrs:{label:"严重程度",prop:"importance"},scopedSlots:t._u([{key:"default",fn:function(e){return i("div",{},["致命"===e.row.importance?i("el-tag",{attrs:{effect:"dark",type:"danger",size:"small"}},[t._v(t._s(e.row.importance))]):"严重"===e.row.importance?i("el-tag",{attrs:{effect:"dark",type:"warning",size:"small"}},[t._v(t._s(e.row.importance))]):"一般"===e.row.importance?i("el-tag",{attrs:{effect:"dark",type:"success",size:"small"}},[t._v(t._s(e.row.importance))]):i("el-tag",{attrs:{effect:"dark",type:"info",size:"small"}},[t._v(t._s(e.row.importance))])],1)}}])}),t._v(" "),i("el-table-column",{attrs:{label:"迭代",prop:"iteration"}}),t._v(" "),i("el-table-column",{attrs:{label:"状态",prop:"state"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-select",{attrs:{size:"small"},on:{change:function(i){return t.stateChange(e.row.id,e.row.state)}},model:{value:e.row.state,callback:function(i){t.$set(e.row,"state",i)},expression:"scope.row.state"}},t._l(t.option,function(t){return i("el-option",{key:t.value,attrs:{value:t.value,label:t.label}})}),1)]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"处理人",prop:"handler"}}),t._v(" "),i("el-table-column",{attrs:{label:"创建人",prop:"creator"}}),t._v(" "),i("el-table-column",{attrs:{label:"创建时间",prop:"createTime"}}),t._v(" "),i("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return i("div",{},[i("el-button",{attrs:{size:"small",type:"warning"},on:{click:function(i){t.dialogVisible=!0,t.editOrAdd="edit",t.getEditDefectForm(e.row.id)}}},[t._v("详情")]),t._v(" "),"管理员"===t.$cookies.get("user_type")?i("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(i){return t.delDefect(e.row.id)}}},[t._v("删除")]):t._e()],1)}}])})],1)],1)],1),t._v(" "),i("LinkDialog",{attrs:{vs:t.linkDialogVisible,type:"testCase",selectionArr:this.selectionArr},on:{getLinkDialogVs:t.getLinkDialogVs}}),t._v(" "),i("DefectDialog",{attrs:{vs:t.dialogVisible,ea:t.editOrAdd,editForm:t.editForm},on:{getVs:t.getVs,fresh:t.fresh}})],1)},staticRenderFns:[]};var g=i("VU/8")(v,_,!1,function(t){i("t5JP")},"data-v-067fb930",null);e.default=g.exports},t5JP:function(t,e){},tpac:function(t,e){}});